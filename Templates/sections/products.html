<style>
    .text-danger { color: #e74c3c !important; font-weight: bold; }
    input.centered { text-align: center; border-radius: 4px; border: 1px solid #ddd; padding: 5px; }
    table { width: 100%; border-collapse: collapse; text-align: center; }
    th, td { padding: 12px; border-bottom: 1px solid #eee; }
    .btn-add { background: #2ecc71; color: white; border: none; padding: 10px 20px; border-radius: 8px; cursor: pointer; float: right; margin-bottom: 20px; font-weight: bold; }
</style>




<div style="overflow: hidden;">
    <input type="text" id="tableSearch" onkeyup="liveSearch()" placeholder="Search items..." style="width: 25%; padding: 12px; border-radius: 8px; border: 1px solid #ddd; text-align: left; margin-bottom: 20px;">
    <button class="btn-add" onclick="openModal()">+ Add Product</button>
</div>
<table>
    <thead><tr><th>Item</th><th>Category</th><th>Stock</th><th>Price</th><th>Action</th></tr></thead>
    <tbody>
        {% for product in products %}
        <tr>
            <td>{{ product.name }} ({{ product.size }})</td>
            <td>{{ product.category }}</td>
            <td class="{{ 'text-danger' if product.stock <= threshold else '' }}">
                {{ product.stock }}
                {% if product.stock <= threshold %}<br><small>(LOW)</small>{% endif %}
            </td>
            <td>â‚±{{ "%.2f"|format(product.price) }}</td>
            <td>
                <input type="number" id="qty-{{ product.id }}" value="1" min="1" class="centered" style="width: 50px;">
                <button onclick="sellItem({{ product.id }}, '{{ product.category }}', '{{ product.name }}', '{{ product.size }}')" style="background: #f39c12; color: white; border: none; padding: 6px 12px; border-radius: 4px; cursor: pointer;">Sell</button>
            </td>
        </tr>
        {% endfor %}
    </tbody>
</table>

<div id="productModal" style="display:none; position:fixed; z-index:100; left:0; top:0; width:100%; height:100%; background:rgba(0,0,0,0.5);">
    <div style="background: white; width: 300px; margin: 10% auto; padding: 25px; border-radius: 10px; text-align: center;">
        <h3>New Product</h3>
        <form id="addProductForm">
            <input type="text" name="name" placeholder="Name" required style="width: 94%; margin-bottom: 10px; padding: 8px; text-align: center;">
            <input type="text" name="category" placeholder="Category" required style="width: 94%; margin-bottom: 10px; padding: 8px; text-align: center;">
            <input type="number" name="stock" placeholder="Initial Stock" required style="width: 94%; margin-bottom: 10px; padding: 8px; text-align: center;">
            <input type="number" step="0.01" name="price" placeholder="Price" required style="width: 94%; margin-bottom: 10px; padding: 8px; text-align: center;">
            <button type="submit" style="width: 100%; background: #3498db; color: white; padding: 10px; border: none; border-radius: 5px;">Save</button>
            <button type="button" onclick="closeModal()" style="background: none; border: none; color: gray; margin-top: 10px; cursor: pointer;">Cancel</button>
        </form>
    </div>
</div>